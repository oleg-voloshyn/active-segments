<table>
  <thead>
    <tr>
      <th>Учасник</th>
      <% @segments.each do |segment| %>
        <th><%=link_to segment.name, "https://www.strava.com/segments/#{segment.link}", target: "_blank" %></th>
      <% end %>
    </tr>
  </thead>

  <tbody>
    <% @users.each_with_index do |user, index| %>
      <tr>
        <td>
          <p class="user-avatar"><%=image_tag "avatars/#{user.bib}.jpg", height: '96', width: '96'%></p>
          <p class="user-name"><%=link_to user.full_name, "#{user.link}", target: "_blank" %></p>
          <p>
            <span><b>Місце: </b></span>
            <span><%= index + 1 %></span>
          </p>
          <p>
            <span><b>Рейтинг: </b></span>
            <span><%= user.results.pluck(:points).sum %></span>
          </p>
          <p>
            <span><b>bib: </b></span>
            <span><%= user.bib %></span>
          </p>
        </td>
        <% user.results.order(:segment_id).each do |result| %>
          <td>
            <div>
              <span><strong><%= result.points %></strong></span>
            </div>
            <div>
              <span><strong>Час: </strong></span>
              <span><%= seconds_to_hms(result.moving_time) %></span>
            </div>
          </td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>

